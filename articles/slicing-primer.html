<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Slicing: primer | Jakub Tes√°rek</title>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Introduction to slicing and indexing in Python">

        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

        <link rel="stylesheet" href="/style/main.css">
        <link rel="stylesheet" href="/style/color-brewer.css">
        <link rel="stylesheet" href="/style/figures.css">

        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155995840-1"></script>
        <script type="text/javascript" src="/script/highlight.pack.js"></script>
        <script type="text/javascript" src="/script/setup.js"></script>
        <script type="text/javascript" src="//downloads.mailchimp.com/js/signup-forms/popup/unique-methods/embed.js" data-dojo-config="usePlainJson: true, isDebug: false"></script><script type="text/javascript">window.dojoRequire(["mojo/signup-forms/Loader"], function(L) { L.start({"baseUrl":"mc.us4.list-manage.com","uuid":"db9cdab3c81c5706fb0ede08a","lid":"44f897bb92","uniqueMethods":true}) })</script>
    </head>
    <body>
        <header>
            <menu>
                <ul class="navigation">
                    <li><a href="https://tesarek.me">Home</a></li>
                    <li><a href="https://tesarek.me#publications">Publications</a></li>
                    <li><a href="https://tesarek.us4.list-manage.com/subscribe/post?u=db9cdab3c81c5706fb0ede08a&id=44f897bb92">Subscribe</a></li>
                </ul>
            </menu>
        </header>
        <main>
            <article class="content">
                <header>
                    <h1>Slicing: primer</h1>
                    <p>Slicing and indexing are two basic operations used to retrieve data from a list in Python. In the first part of this 3-part series we'll
                        look at what slicing (and indexing) is and we'll go through practical examples that's you can use in your code. At the end we'll look
                        at very powerful slice assignment.</p>
                </header>

                <nav>
                    <ul>
                        <li>
                            <a href=".">Slicing: primer</a>
                            <ul>
                                <li><a href="#indexing">Indexing</a></li>
                                <li><a href="#slicing">Slicing</a></li>
                                <li><a href="#slice-assignment">Slice assignment</a></li>
                            </ul>
                        </li>
                        <li>Slicing: multi-dimensional arrays</li>
                        <li>Slicing: under the hood</li>
                    </ul>
                </nav>

                <h2 id="indexing">Indexing</h2>
                <p>Indexing allows you to retrieve one element by its index.</p>

                <pre><code class="python">l = ['A', 'B', 'C', 'D']
result = l[2] # result == 'C'</code></pre>

                <aside><p>Notice that the first element at position <code class="python">0</code>, that's because <b>lists in Python are indexed from zero</b>.</p></aside>
                <p>If you know which element you want relative to the end of the list, you can access it by a negative index.</p>

                <pre><code class="python">l = ['A', 'B', 'C', 'D']
result = l[-1] # result == 'D'</code></pre>

                <aside><p>I just said that first element is at position <code class="python">0</code> so why does index <code class="python">-1</code> contains the first element from the
                    end and not the second one? That's because there's no such thing as a negative zero. Therefore, <b>lists are indexed from <code class="python">-1</code>
                    when counting from the end</b>. Be careful, this often causes bugs.</p></aside>

                <p>If you try to access an index that doesn't exist in the list, Python will raise an exception.</p>
                <pre><code class="python">l = ['A', 'B', 'C', 'D']
result = l[100] # IndexError: list index out of range</code></pre>

                <h2 id="slicing">Slicing</h2>
                <p>Slicing is similar to indexing but instead of one element it allows you to retrieve multiple elements. It basically constructs new list
                    and fills it with elements from the original list based on 3 criteria. Basic syntax looks like this <code class="python">my_list[start:end:step]</code>.

                <p><code class="python">Start</code> is the index of first elements we want. Sometimes you can omit this value and Python will simply start at the first element.</p>

                <p>All elements up to <code class="python">end</code> value will be included, except the element on that index itself. You can omit this
                    value and Python will automatically assume you mean "until the end of the list".</p>

                <p><code class="python">Step</code> tells Python how many elements it should move in each step. By default,
                    this value is <code class="python">1</code> meaning it will include every element between <code class="python">start</code> and <code class="python">end</code>. Value of <code class="python">2</code> means every 2<sup>nd</sup> element etc.</p>

                <pre><code class="python">l = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
result = l[1:3:1] # result = [1, 2]
result = l[2:8:3] # result = [2, 5]</code></pre>

                <p>When you use <code class="python">start</code>, <code class="python">end</code> or <code class="python">step</code> that's outside of the range of the list, or
                    your indexes mismatch, for example you start on later index than end: <code class="python">l[100:1:1]</code>, Python will not raise
                    an exception. It will try to return something. If you for example use <code class="python">end</code> that's outside the list,
                    it will return all elements up to the actual end of the list. If your arguments didn't match any elements, you'll get an empty list.</p>

                <pre><code class="python">l = [0, 1, 2, 3]
result = l[100:102] # result == []</pre></code>

                <p>Let's look at some more examples. For the rest of this section we'll use a list defined like this <code class="python">l = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</code> and
                    to make it easier to understand what exactly is going on, we'll visualize it like this:</p>

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>0</td>
                      <td>1</td>
                      <td>2</td>
                      <td>3</td>
                      <td>4</td>
                      <td>5</td>
                      <td>6</td>
                      <td>7</td>
                      <td>8</td>
                      <td>9</td>
                    </tr>
                  </table>
                </figure>

                <h3>First 3 values</h3>
                <p>You can retrieve first 3 values like this <code class="python">l[:3]</code>. We didn't use the <code class="python">start</code>
                    arguments as it's <code class="python">0</code> by default and therefore unnecessary.</p>
                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>0</td>
                      <td>1</td>
                      <td>2</td>
                      <td class="unselected">3</td>
                      <td class="unselected">4</td>
                      <td class="unselected">5</td>
                      <td class="unselected">6</td>
                      <td class="unselected">7</td>
                      <td class="unselected">8</td>
                      <td class="unselected">9</td>
                    </tr>
                  </table>
                </figure>

                <h3>Last 3 values</h3>
                <p>Similarly to previous example, you can get last three arguments using this code <code class="python">l[-3:]</code>. We start 3
                    elements from the end and continue until the end of the list.</p>
                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td class="unselected">0</td>
                      <td class="unselected">1</td>
                      <td class="unselected">2</td>
                      <td class="unselected">3</td>
                      <td class="unselected">4</td>
                      <td class="unselected">5</td>
                      <td class="unselected">6</td>
                      <td>7</td>
                      <td>8</td>
                      <td>9</td>
                    </tr>
                  </table>
                </figure>

                <p>If we want, we can retrieve the values in reversed order <code class="python">l[:-4:-1]</code>.
                <aside><p>Why did we used <code class="python">-4</code> and not <code class="python">-3</code> like in previous example?
                    In previous example the <code class="python">-3</code> was a first argument, which are always included in the resulting list.
                    in this example it's the second argument and they are never included. That means we need to add 1 to this argument. But at the
                    same time, we are traversing the list in reversed order, therefore we have to subtract 1 instead.</p></aside>
                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>9</td>
                      <td>8</td>
                      <td>7</td>
                      <td class="unselected">6</td>
                      <td class="unselected">5</td>
                      <td class="unselected">4</td>
                      <td class="unselected">3</td>
                      <td class="unselected">2</td>
                      <td class="unselected">1</td>
                      <td class="unselected">0</td>
                    </tr>
                  </table>
                </figure>

                <h3>Cut of ends</h3>
                <p>Sometimes you might want the same list but without first and last value (or multiple): <code class="python">l[1:-1]</code>.</p>

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td class="unselected">0</td>
                      <td>1</td>
                      <td>2</td>
                      <td>3</td>
                      <td>4</td>
                      <td>5</td>
                      <td>6</td>
                      <td>7</td>
                      <td>8</td>
                      <td class="unselected">9</td>
                    </tr>
                  </table>
                </figure>
                <h3>Every other value</h3>
                <p>To select each other value, we can omit first two arguments, and simply do <code class="python">l[::2]</code>, this is equivalent
                    to <code class="python">l[0:len(l):2]</code>, just shorter.

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>0</td>
                      <td class="unselected">1</td>
                      <td>2</td>
                      <td class="unselected">3</td>
                      <td>4</td>
                      <td class="unselected">5</td>
                      <td>6</td>
                      <td class="unselected">7</td>
                      <td>8</td>
                      <td class="unselected">9</td>
                    </tr>
                  </table>
                </figure>

                <aside><p><b>Remember:</b> If you skip some arguments, like the first two in this example, it's important to still include the "<code class="python">:</code>". Otherwise
                    You don't have to if you omit arguments from the end.</p></aside>


                <h3>Reversing a list</h3>
                <p>Python has very nice "trick" you can use to reverse a list: <code class="python">l[::-1]</code>. It simply means: The first missing arguments make
                    sure you use elements from the beginning to the end, the <code class="python">-1</code> reverses the direction in which the list is processed.</code>

                <p>In full, without skipping arguments it would look like this <code class="python">l[len(l):-(len(l)+1):-1]</code>.
                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>9</td>
                      <td>8</td>
                      <td>7</td>
                      <td>6</td>
                      <td>5</td>
                      <td>4</td>
                      <td>3</td>
                      <td>2</td>
                      <td>1</td>
                      <td>0</td>
                    </tr>
                  </table>
                </figure>

                <p>Because strings in Python also support slicing, this trick is quite often used. Here's a simple function that detects if given string is a palindrome:</p>
                <pre><code class="python">def is_palindrome(s: str) -> bool:
    return s == s[::-1]</code></pre>

                <h3>Copying a list</h3>
                <p>Lists are mutable structures; if you add or remove elements in one part of code, it will change all reverences pointing to the same list. That's why you often
                    need to copy a list to make sure, you can safely work with it (one of the principles of <a href="https://en.wikipedia.org/wiki/Defensive_programming">Defensive programming</a>.</p>
                <p>Because we know that slicing produces new list, the easiest way to make a copy is simply <code class="python">l[:]</code> which is equivalent to <code class="python">l[0:len(l):1]</code>. We omitted all the arguments
                    and just include single <code class="python">:</code> to signal our intent to use slicing.</p>

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>0</td>
                      <td>1</td>
                      <td>2</td>
                      <td>3</td>
                      <td>4</td>
                      <td>5</td>
                      <td>6</td>
                      <td>7</td>
                      <td>8</td>
                      <td>9</td>
                    </tr>
                  </table>
                </figure>

                <h3>Surrounding a value</h3>
                <p>Another trick that you'll use mostly with strings is finding surrounding elements. Imagine you're writing a function that
                    searches for a string in another string. When presenting the data to the user, it's good idea to include some character before
                    and after the find string.</p>

                <pre><code class="python">from typing import Optional

def search_text(what: str, where: str, padding: int) -> Optional[str]:
    """ Find first occurance of a substring.

    If `what` is found, in `where` return it surrounded by ```padding```
    number of characters.
    """
    index = where.index(what)
    if index is not None:
        start = max(index - padding, 0) # Prevent negative values
        end = index + padding + len(what)
        return where[start:end]

result = search_text('Wo', 'Hello World!', 3) # result == 'lo World'</code></pre>

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>H</td>
                      <td>e</td>
                      <td>l</td>
                      <td>l</td>
                      <td>o</td>
                      <td> </td>
                      <td>W</td>
                      <td>o</td>
                      <td>r</td>
                      <td>l</td>
                      <td>d</td>
                      <td>!</td>
                    </tr>
                 </table>
                </figure>
                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td class="unselected">H</td>
                      <td class="unselected">e</td>
                      <td class="unselected">l</td>
                      <td>l</td>
                      <td>o</td>
                      <td> </td>
                      <td>W</td>
                      <td>o</td>
                      <td>r</td>
                      <td>l</td>
                      <td>d</td>
                      <td class="unselected">!</td>
                    </tr>
                  </table>
                </figure>

                <h3>Batch processing</h3>
                <p>Batch processing is very common software engineering problem. You have a list of items you need to process (eg. records that need to be stored in DB)
                    and you need to split the items into smaller batches. One way to do it is to use slicing, and list comprehension. Let's look at the solution first
                    and then I'll explain the details.</p>

                <pre><code class="python">from typing import List, Any

def split_to_batches(l: List, batch_size: int) -> List[List[Any]]:
    """ Split list to smaller lists """
    return [l[i:i + batch_size] for i in range(0, len(l), batch_size)]

l = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
batches = split_to_batches(l, 3) # batches == [[0, 1, 2], [3, 4, 5], [6, 7, 8], [9]]</code></pre>

                <figure class="scene scene1d">
                  <table class="panel index2">
                    <tr>
                      <td>0</td>
                      <td>1</td>
                      <td>2</td>
                      <td class="unselected">3</td>
                      <td class="unselected">4</td>
                      <td class="unselected">5</td>
                      <td class="unselected">6</td>
                      <td class="unselected">7</td>
                      <td class="unselected">8</td>
                      <td class="unselected">9</td>
                    </tr>
                    <tr>
                      <td class="unselected">0</td>
                      <td class="unselected">1</td>
                      <td class="unselected">2</td>
                      <td>3</td>
                      <td>4</td>
                      <td>5</td>
                      <td class="unselected">6</td>
                      <td class="unselected">7</td>
                      <td class="unselected">8</td>
                      <td class="unselected">9</td>
                    </tr>
                    <tr>
                      <td class="unselected">0</td>
                      <td class="unselected">1</td>
                      <td class="unselected">2</td>
                      <td class="unselected">3</td>
                      <td class="unselected">4</td>
                      <td class="unselected">5</td>
                      <td>6</td>
                      <td>7</td>
                      <td>8</td>
                      <td class="unselected">9</td>
                    </tr>
                    <tr>
                      <td class="unselected">0</td>
                      <td class="unselected">1</td>
                      <td class="unselected">2</td>
                      <td class="unselected">3</td>
                      <td class="unselected">4</td>
                      <td class="unselected">5</td>
                      <td class="unselected">6</td>
                      <td class="unselected">7</td>
                      <td class="unselected">8</td>
                      <td class="index2">9</td>
                    </tr>
                  </table>
                </figure>

                <p>How does it work? At this point you should understand that <code class="python">l[:batch_size]</code> returns <code class="python">batch_size</code> numbers of items from the beginning.
                    Similarly <code class="python">l[i:i + batch_size]</code> returns <code class="python">batch_size</code> number of items starting from <code class="python">i</code>.</p>
                <p>We just need to generate <code class="python">i</code> so that it starts at <code class="python">0</code> and in each step, it increases by <code class="python">batch_size</code>. That's what
                    <code class="python">range(0, len(l), batch_size)</code> does. <a href="https://docs.python.org/3/library/functions.html#func-range"><code class="python">Range</code></a> generates an integer sequence. The
                    arguments are very similar to slicing; first argument is the starting number, second is the maximum number and the last one is the step size.
                    We use this here to create a sequence of <code class="python">[0, 3, 6, 9]</code> up to the length of the original series.</p>

                <p>Then we just have to put all together using <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions">list comprehension</a>. I recommend
                    reading the documentation regarding this feature, it's bit out of scope of this article.</p>

                <aside><p>This batching function is very primitive and has some limitations. The biggest one is that it has to has to know how long of list will you split to batches.
                    sometimes, instead of a list, you have an iterator, or the list is generated by another thread. For more advanced function, look at <a href="https://github.com/JakubTesarek/colltools/blob/master/colltools/__init__.py">colltools:batch</a>.</p></aside>

                <h2 id="slice-assignment">Slice assignment</h2>
                <p>Slice assignment is a tool that makes it possible to replace parts of one list with another list. The syntax looks like this:<p>
                <pre><code class="python">first_list[start:end:step] = second_list</code></pre>
                <p>The part left of <code class="python">=</code> specifies which elements will be removed, the part on right is an iterable providing new elements.</p>

                <pre><code class="python">l1 = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
l2 = ['A', 'B', 'C']
l1[:3] = l2 # l1 = ['A', 'B', 'C', 3, 4, 5, 6, 7, 8, 9]</code></pre>

                <figure class="scene scene1d">
                    <p>l1:</p>
                    <table class="panel index2">
                        <tr>
                          <td>0</td>
                          <td>1</td>
                          <td>2</td>
                          <td>3</td>
                          <td>4</td>
                          <td>5</td>
                          <td>6</td>
                          <td>7</td>
                          <td>8</td>
                          <td>9</td>
                        </tr>
                      </table>
                    <p>l2:</p>
                      <table class="panel index1">
                        <tr>
                          <td>A</td>
                          <td>B</td>
                          <td>C</td>
                        </tr>
                      </table>
                    <p>resulting l1:</p>
                    <table class="panel index2">
                        <tr>
                          <td class="index1">A</td>
                          <td class="index1">B</td>
                          <td class="index1">C</td>
                          <td>3</td>
                          <td>4</td>
                          <td>5</td>
                          <td>6</td>
                          <td>7</td>
                          <td>8</td>
                          <td>9</td>
                        </tr>
                      </table>
                </figure>

                <p>Slice assignment can change the size of origin list. If you assign more elements than you specify for replacement, the resulting list
                    will be longer and vice versa.</p>

                <pre><code class="python">l1[-5:] = l2 # l1 = [0, 1, 2, 3, 4, 'A', 'B', 'C']</code></pre>

                <figure class="scene scene1d">
                    <table class="panel index2">
                        <tr>
                          <td>0</td>
                          <td>1</td>
                          <td>2</td>
                          <td>3</td>
                          <td>4</td>
                          <td class="index1">A</td>
                          <td class="index1">B</td>
                          <td class="index1">C</td>
                        </tr>
                      </table>
                </figure>

                <p>We can even use more advanced slicing constructs, for example:</p>
                <pre><code class="python">l1[:4:-2] = l2 # l1 = [0, 1, 2, 3, 4, 'C', 6, 'B', 8, 'A']</code></pre>

                <figure class="scene scene1d">
                    <table class="panel index2">
                        <tr>
                          <td>0</td>
                          <td>1</td>
                          <td>2</td>
                          <td>3</td>
                          <td>4</td>
                          <td class="index1">C</td>
                          <td>6</td>
                          <td class="index1">B</td>
                          <td>8</td>
                          <td class="index1">A</td>
                        </tr>
                      </table>
                </figure>

                <p>There's one caveat thought. If you use the third argument <code class="python">step</code>, you cannot change the size of the resulting list; you
                    have to match the size exactly otherwise you'll get <code class="python">ValueError</code>.
                <pre><code class="python">l1[::2] = l2
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ValueError: attempt to assign sequence of size 3 to extended slice of size 5</code></pre>

                <p>Thank you for reading this introduction to slicing. In next part we'll look at more advanced topic - slicing multi-dimensional arrays.
                    <a href="https://tesarek.us4.list-manage.com/subscribe/post?u=db9cdab3c81c5706fb0ede08a&id=44f897bb92">Make sure you don't miss it and subscribe.</a></p>

                <aside>
                    <p>Did you find an issue with this article? Please <a href="https://github.com/JakubTesarek/tesarek.me/issues/new">file a bug report</a>
                        or even better, <a href="https://github.com/JakubTesarek/tesarek.me/edit/master/articles/slicing-primer.html">send a pull request</a>.
                        Thank you!</a></p>
                 </aside>
            </article>
        </main>
        <footer>
            <section>
                <a class="icon external" href="mailto:jakub@tesarek.me">&#xf0e0;</a>
                <a class="icon external" href="https://www.instagram.com/tesarekjakub/">&#xf16d;</a>
                <a class="icon external" href="https://github.com/JakubTesarek">&#xf300;</a>
                <a class="icon external" href="https://www.linkedin.com/in/jakubtesarek/">&#xf30c;</a>
                <a class="icon external" href="https://twitter.com/JakubTesarek">&#xf304;</a>
            </section>
        </footer>
    </body>
</html>
